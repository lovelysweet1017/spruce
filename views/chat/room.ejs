<!DOCTYPE html>
<html>
  <%- include('../head') -%>
    <link rel="stylesheet" type="text/css" href="/stylesheets/moment.css">
    <link type="text/css" rel="stylesheet" media="screen" href="/animations/jquery-sakura.min.css" />
  <body>
  <%- include('../navbar')	-%>
    <br>
    <div class="container">
      <ul class="list-group">
  <% for(var i=0;i<room.chats.length;i++) { %>
    <li class="list-group-item">

        <img style="height:5%; width:5%; border-radius: 50%; margin-right: 1rem" src="<%= room.chats[i].by.profile_pic %>">  
        <%= room.chats[i].txt %>

    </li>
  <% } %>
</ul>
    </div>
    <div class="container navbar-fixed-bottom" style="padding-bottom:100px;">
      <input type="text" class="form-control" id="msg" placeholder="Type something...">
    </div>
    <%- include('../tabs') %>
    <%- include('../footer') -%>
  </body>
  <script src="/javascripts/socket.io.js" charset="utf-8"></script>
  <script type="text/javascript">
    var socket = io();
    socket.on('connect', function (data) {
      console.log('Connected')
    });
    socket.on('new msg', function (data) {
      addMessage(data);
    });
    socket.on('typing', function (data) {
      console.log(data);
    });
    function trySendingMsg(e) {
      if(e.keyCode == 13) {
        var data = {
          txt:e.target.value,
          time:new Date()
        }
        socket.emit('msg', data)
        addMessage(data);
        $("#msg").val('');
      }
      else {
        socket.emit('typing', {
        });
      }
    }

    $("#msg").on("keydown", trySendingMsg);

  </script>
</html>
